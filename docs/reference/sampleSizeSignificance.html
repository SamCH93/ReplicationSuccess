<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Computes the required relative sample size to achieve significance
based on power or on the minimum relative effect size — sampleSizeSignificance • ReplicationSuccess</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Computes the required relative sample size to achieve significance
based on power or on the minimum relative effect size — sampleSizeSignificance" />
<meta property="og:description" content="The relative sample size to achieve significance of the replication study is
computed based on the z-value of the original study, the significance level
and either the power or the minimum relative effect size. When the approach
based on power is used, the arguments design prior, shrinkage, and relative
heterogeneity also have to be specified." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ReplicationSuccess</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/SamCH93/ReplicationSuccess/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Computes the required relative sample size to achieve significance
based on power or on the minimum relative effect size</h1>
    <small class="dont-index">Source: <a href='https://github.com/SamCH93/ReplicationSuccess/blob/master/R/sampleSizeSignificance.R'><code>R/sampleSizeSignificance.R</code></a></small>
    <div class="hidden name"><code>sampleSizeSignificance.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The relative sample size to achieve significance of the replication study is
computed based on the z-value of the original study, the significance level
and either the power or the minimum relative effect size. When the approach
based on power is used, the arguments design prior, shrinkage, and relative
heterogeneity also have to be specified.</p>
    </div>

    <pre class="usage"><span class='fu'>sampleSizeSignificance</span><span class='op'>(</span>
  <span class='va'>zo</span>,
  power <span class='op'>=</span> <span class='cn'>NA</span>,
  d <span class='op'>=</span> <span class='cn'>NA</span>,
  level <span class='op'>=</span> <span class='fl'>0.025</span>,
  alternative <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"one.sided"</span>, <span class='st'>"two.sided"</span><span class='op'>)</span>,
  designPrior <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"conditional"</span>, <span class='st'>"predictive"</span>, <span class='st'>"EB"</span><span class='op'>)</span>,
  h <span class='op'>=</span> <span class='fl'>0</span>,
  shrinkage <span class='op'>=</span> <span class='fl'>0</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>zo</th>
      <td><p>A vector of z-values from original studies.</p></td>
    </tr>
    <tr>
      <th>power</th>
      <td><p>The power to achieve replication success.</p></td>
    </tr>
    <tr>
      <th>d</th>
      <td><p>The minimum relative effect size (ratio of the effect estimate from
the replication study to the effect estimate from the original study).</p></td>
    </tr>
    <tr>
      <th>level</th>
      <td><p>Significance level. Default is 0.025.</p></td>
    </tr>
    <tr>
      <th>alternative</th>
      <td><p>Either "one.sided" (default) or "two.sided". Specifies
direction of the alternative. "one.sided" assumes an effect in the same
direction as the original estimate.</p></td>
    </tr>
    <tr>
      <th>designPrior</th>
      <td><p>Is only taken into account when <code>power</code> is specified.
Either "conditional" (default), "predictive", or "EB". If "EB", the power
is computed under a predictive distribution where the contribution of the
original study is shrunken towards zero based on the evidence in the
original study (with an empirical Bayes shrinkage estimator).</p></td>
    </tr>
    <tr>
      <th>h</th>
      <td><p>Is only taken into account when <code>power</code> is specified and
<code>designPrior</code> is "predictive" or "EB". The relative between-study
heterogeneity, i.e., the ratio of the heterogeneity variance to the
variance of the original effect estimate. Default is 0 (no
heterogeneity).</p></td>
    </tr>
    <tr>
      <th>shrinkage</th>
      <td><p>Is only taken into account when <code>power</code> is specified. A
number in [0,1) with default 0. Specifies the shrinkage of the original effect
towards zero (e.g., <code>shrinkage = 0.25</code> implies shrinkage by a
factor of 25%). Is only taken into account when <code>designPrior</code> is
"conditional" or "predictive".</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The relative sample size to achieve significance in the specified
    direction. If impossible to achieve the desired power for specified
    inputs <code>NaN</code> is returned.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>sampleSizeSignificance</code> is the vectorized version of
    <code>.sampleSizeSignificance_</code>. <code><a href='https://rdrr.io/r/base/Vectorize.html'>Vectorize</a></code> is used to
    vectorize the function.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Held, L. (2020). A new standard for the analysis and design of replication
studies (with discussion). <em>Journal of the Royal Statistical Society:
Series A (Statistics in Society)</em>, <b>183</b>, 431-448.
doi: <a href='https://doi.org/10.1111/rssa.12493'>10.1111/rssa.12493</a></p>
<p>Pawel, S., Held, L. (2020). Probabilistic forecasting of replication studies.
<em>PLoS ONE</em>. <b>15</b>, e0231416. doi: <a href='https://doi.org/10.1371/journal.pone.0231416'>10.1371/journal.pone.0231416</a></p>
<p>Held, L., Micheloud, C., Pawel, S. (2021). The assessment of replication
success based on relative effect size. <a href='https://arxiv.org/abs/2009.07782'>https://arxiv.org/abs/2009.07782</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='powerSignificance.html'>powerSignificance</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Leonhard Held, Samuel Pawel, Charlotte Micheloud, Florian Gerber</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>sampleSizeSignificance</span><span class='op'>(</span>zo <span class='op'>=</span> <span class='fu'><a href='ci2se.html'>p2z</a></span><span class='op'>(</span><span class='fl'>0.005</span><span class='op'>)</span>, power <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 0.9961217</div><div class='input'><span class='fu'>sampleSizeSignificance</span><span class='op'>(</span>zo <span class='op'>=</span> <span class='fu'><a href='ci2se.html'>p2z</a></span><span class='op'>(</span><span class='fl'>0.005</span>, alternative <span class='op'>=</span> <span class='st'>"two.sided"</span><span class='op'>)</span>, power <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 0.9961217</div><div class='input'><span class='fu'>sampleSizeSignificance</span><span class='op'>(</span>zo <span class='op'>=</span> <span class='fu'><a href='ci2se.html'>p2z</a></span><span class='op'>(</span><span class='fl'>0.005</span><span class='op'>)</span>, power <span class='op'>=</span> <span class='fl'>0.8</span>, designPrior <span class='op'>=</span> <span class='st'>"predictive"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 1.337889</div><div class='input'>
<span class='fu'>sampleSizeSignificance</span><span class='op'>(</span>zo <span class='op'>=</span> <span class='fl'>3</span>, power <span class='op'>=</span> <span class='fl'>0.8</span>, designPrior <span class='op'>=</span> <span class='st'>"predictive"</span>,
                       shrinkage <span class='op'>=</span> <span class='fl'>0.5</span>, h <span class='op'>=</span> <span class='fl'>0.25</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 18.87111</div><div class='input'><span class='fu'>sampleSizeSignificance</span><span class='op'>(</span>zo <span class='op'>=</span> <span class='fl'>3</span>, power <span class='op'>=</span> <span class='fl'>0.8</span>, designPrior <span class='op'>=</span> <span class='st'>"EB"</span>,  h <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 2.412774</div><div class='input'>
<span class='co'># sample size to achieve  0.8 power as function of original p-value</span>
<span class='va'>zo</span> <span class='op'>&lt;-</span> <span class='fu'><a href='ci2se.html'>p2z</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0.0001</span>, <span class='fl'>0.05</span>, <span class='fl'>0.0001</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>oldPar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='ci2se.html'>z2p</a></span><span class='op'>(</span><span class='va'>zo</span><span class='op'>)</span>, <span class='fu'>sampleSizeSignificance</span><span class='op'>(</span>zo <span class='op'>=</span> <span class='va'>zo</span>, designPrior <span class='op'>=</span> <span class='st'>"conditional"</span>, power <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span>,
     type <span class='op'>=</span> <span class='st'>"l"</span>, ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>10</span><span class='op'>)</span>, log <span class='op'>=</span> <span class='st'>"y"</span>, lwd <span class='op'>=</span> <span class='fl'>1.5</span>, ylab <span class='op'>=</span> <span class='st'>"Relative sample size"</span>,
     xlab <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/grDevices/plotmath.html'>italic</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span><span class='op'>[</span><span class='va'>o</span><span class='op'>]</span><span class='op'>)</span>, las <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='fu'><a href='ci2se.html'>z2p</a></span><span class='op'>(</span><span class='va'>zo</span><span class='op'>)</span>, <span class='fu'>sampleSizeSignificance</span><span class='op'>(</span>zo <span class='op'>=</span> <span class='va'>zo</span>, designPrior <span class='op'>=</span> <span class='st'>"predictive"</span>, power <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span>,
      lwd <span class='op'>=</span> <span class='fl'>2</span>, lty <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='fu'><a href='ci2se.html'>z2p</a></span><span class='op'>(</span><span class='va'>zo</span><span class='op'>)</span>, <span class='fu'>sampleSizeSignificance</span><span class='op'>(</span>zo <span class='op'>=</span> <span class='va'>zo</span>, designPrior <span class='op'>=</span> <span class='st'>"EB"</span>, power <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span>,
      lwd <span class='op'>=</span> <span class='fl'>1.5</span>, lty <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span><span class='op'>(</span><span class='st'>"topleft"</span>, legend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"conditional"</span>, <span class='st'>"predictive"</span>, <span class='st'>"EB"</span><span class='op'>)</span>,
       title <span class='op'>=</span> <span class='st'>"Design prior"</span>, lty <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span>, lwd <span class='op'>=</span> <span class='fl'>1.5</span>, bty <span class='op'>=</span> <span class='st'>"n"</span><span class='op'>)</span>

<span class='fu'>sampleSizeSignificance</span><span class='op'>(</span>zo <span class='op'>=</span> <span class='fu'><a href='ci2se.html'>p2z</a></span><span class='op'>(</span><span class='fl'>0.005</span><span class='op'>)</span>, d <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 0.4875295</div><div class='input'><span class='fu'>sampleSizeSignificance</span><span class='op'>(</span>zo <span class='op'>=</span> <span class='fu'><a href='ci2se.html'>p2z</a></span><span class='op'>(</span><span class='fl'>0.005</span><span class='op'>)</span>, d <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 1.950118</div><div class='input'><span class='co'># sample size based on minimum relative effect size of 0.8</span>
<span class='va'>zo</span> <span class='op'>&lt;-</span> <span class='fu'><a href='ci2se.html'>p2z</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0.0001</span>, <span class='fl'>0.05</span>, <span class='fl'>0.0001</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='ci2se.html'>z2p</a></span><span class='op'>(</span><span class='va'>zo</span><span class='op'>)</span>, <span class='fu'>sampleSizeSignificance</span><span class='op'>(</span>zo <span class='op'>=</span> <span class='va'>zo</span>, d <span class='op'>=</span> <span class='fl'>0.8</span>, level <span class='op'>=</span> <span class='fl'>0.025</span><span class='op'>)</span>,
     type <span class='op'>=</span> <span class='st'>"l"</span>, ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>10</span><span class='op'>)</span>, log <span class='op'>=</span> <span class='st'>"y"</span>, lwd <span class='op'>=</span> <span class='fl'>1.5</span>, ylab <span class='op'>=</span> <span class='st'>"Relative sample size"</span>,
    xlab <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/grDevices/plotmath.html'>italic</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span><span class='op'>[</span><span class='va'>o</span><span class='op'>]</span><span class='op'>)</span>, las <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
</div><div class='img'><img src='sampleSizeSignificance-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span><span class='va'>oldPar</span><span class='op'>)</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Leonhard Held, Samuel Pawel, Charlotte Micheloud, Florian Gerber.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


